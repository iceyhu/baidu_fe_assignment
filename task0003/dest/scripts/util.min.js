define(function(){function e(e,t){var t=t instanceof Node?t:document.documentElement,n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,null,!1),r=n.nextNode();switch(!0){case/^#([\w-]+$)/.test(e):for(var i=RegExp.$1;r;){if(r.id===i)return r;r=n.nextNode()}break;case/^\.([\w-]*[\w-\.]+$)/.test(e):for(var a=RegExp.$1.split(".");r;){if(r.hasAttribute("class")){var s=!0;for(var u in a)if(!o(r,a[u])){s=!1;break}if(s)return r}r=n.nextNode()}break;case/^(\w+)$/.test(e):for(var f=RegExp.$1;r;){if(r.nodeName===f.toUpperCase())return r;r=n.nextNode()}break;case/^\[([\w]+)\]$/.test(e):for(var c=RegExp.$1;r;){if(void 0!==r[c])return r;r=n.nextNode()}break;case/^\[(.+)=(.+)\]$/.test(e):for(var c=RegExp.$1,l=RegExp.$2;r;){if(r.getAttribute(c)===l)return r;r=n.nextNode()}}return null}function t(t){var n=t.split(/\s+/);switch(n.length){case 1:return e(n[0]);case 2:var r=e(n[0]);return r===!1?!1:e(n[1],r);case 3:var r=e(n[0]);if(r===!1)return!1;var i=e(n[1],r);return i===!1?!1:e(n[2],i);default:return!1}}function n(e,n,r){if("string"==typeof e&&"string"==typeof n&&"function"==typeof r){var i=t(e);return i===!1?!1:(i.addEventListener?i.addEventListener(n,r,!1):element.attachEvent&&element.attachEvent("on"+n,r),!0)}return!1}function r(e,n,r){if("string"==typeof e&&"string"==typeof n&&"function"==typeof r){var i=t(e);return i===!1?!1:(element.removeEventListener?element.removeEventListener(n,r,!1):element.detachEvent&&element.detachEvent("on"+n,r),!0)}return!1}function i(e,t,r,i){return"string"==typeof e&&"string"==typeof t&&"string"==typeof r&&"function"==typeof i&&n(e,r,function(e){var e=arguments[0]||window.event,n=e.target||e.srcElement;return null!==n&&n.nodeName===t.toUpperCase()?(i.call(n,e),!0):void 0}),!1}function a(e,t,r,i){return"string"==typeof e&&"string"==typeof t&&"string"==typeof r&&"function"==typeof i&&n(e,r,function(e){var e=arguments[0]||window.event,n=e.target||e.srcElement;return null!==n&&o(n,t)?(i.call(n,e),!0):void 0}),!1}function o(e,t){if(1===e.nodeType&&"string"==typeof t){var n=e.getAttribute("class");return null!==n?-1!==n.split(" ").indexOf(t):!1}}function s(e,t){if(1===e.nodeType&&"string"==typeof t){var n=e.getAttribute("class");return null===n?e.setAttribute("class",t):-1===n.split(" ").indexOf(t)&&e.setAttribute("class",n+" "+t),!0}return!1}function u(e,t){if(1===e.nodeType&&"string"==typeof t){var n=e.getAttribute("class");if(null!==n){var r=n.split(" "),i=r.indexOf(t);-1!==i&&(r.splice(i,1),e.setAttribute("class",r.join(" ")))}return!0}return!1}function f(e){if(Array.isArray(e)){for(var t=[],n=0,r=e.length;r>n;n++)-1===t.indexOf(e[n])&&t.push(e[n]);return t}return!1}function c(e){return e.replace(/(^\s+)|(\s+$)/,"")}function l(e){if("string"==typeof e&&/^([012]\d\d\d)-(([01]\d)-([0123]\d))$/.test(e)){var t=parseInt(RegExp.$1),n=parseInt(RegExp.$3),r=parseInt(RegExp.$4),i=RegExp.$2;if(0!==t&&0!==n&&0!==r&&2100>t&&13>n&&32>r&&-1===["02-30","02-31","04-31","06-31","09-31","11-31"].indexOf(i))return!0}return!1}function d(e,n){var r=t("good"===e?".notif.good":".notif.bad");r.innerHTML=n,setTimeout(function(){r.innerHTML=""},3e3)}function p(){var e=window.innerWidth<=900?900:window.innerWidth,n=window.innerHeight<=600?600:window.innerHeight;t("#wrapper").style.width=e+"px",t("#wrapper").style.height=n+"px",t("#category").style.height=t("#tasks").style.height=n-60+"px",t(".tasklist").style.height=n-140+"px",t("#content").style.width=e-480+"px",t("#content .main").style.height=n-200+"px"}function v(e,n){switch(t("#content").innerHTML=e,n){case!0:t("#cover").style.display="block";break;case!1:t("#cover").style.display="none"}p()}function g(e,n){var r=c(t("#content .title").value),i=t("#content .date").value,a=c(t("#content .main").value);if(!r.match(/^.{1,22}$/))return d("bad","任务标题长度应在1至22字之间。"),!1;if(!l(i))return d("bad","任务日期应为yyyy-mm-dd格式。"),!1;if(!a.match(/^.{1,500}$/))return d("bad","任务正文长度应在1至500字之间。"),!1;if(n===!0){var o=e.some(function(e){return e.title===r});if(o)return d("bad","已存在相同名称的任务。"),!1}return!0}function y(e,t){return e.date.replace("-","")>t.date.replace("-","")?-1:1}return t.on=n,t.un=r,t.delegateByTagName=i,t.delegateByClassName=a,t.click=function(e,t){n(e,"click",t)},{$:t,hasClass:o,addClass:s,removeClass:u,uniqArray:f,trim:c,isValidDate:l,showInfo:d,resizeToWindowSize:p,replaceContentHtml:v,validateInput:g,dateDescending:y}});